# 2021-08-02

과제 관련해서 분석 및 테스트 정도 수행했다. 데이터가

## 오늘 수행한 작업

- 클레이튼 노드 관련해서 도커 이미지를 받아서 분석해보고 쿠버네티스 매니페스트 파일을 간단하게 만들어보았다. 데이터는 초기화 컨테이너 써서 먼저 받아오도록 하는 방식을 선택하긴 했는데, 처음에만 이렇게 하고 나중에는 초기화 컨테이너 없이 PV 재활용 하는 쪽으로 써보든지 해야겠다. 설정 파일은 그렇게 복잡하지 않아서 간단하게 configmap으로 변환해뒀다. 정상적으로 잘 되는 거 확인하면 helm chart로 변환해둬야겠다.

## 새롭게 깨달은 점

- init container exec 하려고 하니까 파드 내 컨테이너 처럼 접속은 아니고, `-c` 옵션 붙여서 컨테이너 이름 넣어주면 접속이 됐다.
- GCP에서는 예전에 확인해본바와 같이 PVC만 할당해도 자동으로 PV 생성이 된다. 참 좋은 세상.
- 컨테이너에 직접적으로 데이터를 쓰고, 그 후에 pv로 옮기려 했는데, 그렇게 하니까 Evicted됐다. DiskPressure 때문인듯. 바로 pv로 쓰도록 수정해서 테스트 중. → 맞는듯. 처음에 에러났던 부분을 이번엔 잘 통과하고 있음!

## 새롭게 궁금한 점

- PVC를 스냅샷을 뜨거나 클론을 하려면 CSI를 활성화해야 한다는데, 이 부분은 권한이 없어서 못하는 거 같다. 이건 과제 2번 수행할 때 질문 넣어서 활성화 해주실 수 있는지, 만약 안 되면 다른 방법을 생각해봐야겠다.
- init container 말고 그냥 데이터를 미리 채워놓고 해당 PV를 지속적으로 활용할 수 있는 방법은 없을까?
- node IP는 언제 할당이 되는거지? → 아 혹시 클레이튼 관련 노드 IP가 아니라 걍 서비스에 LB로 할당해서 쓰는 IP 쓰면 되는건가? 맞는 거 같은데?
- ~~LB도 그냥 따로 요청 안드리고 내가 할당 받아서 써도 되는건가?~~ 아 pending이네. 직

## 여담

클레이튼 블럭 데이터가 참 크다. 그런데 일반적으론 테라 단위라고 하니... 놀랍다 ㅋㅋㅋ 나는 아직 우물 안 개구리인 느낌. 데이터가 워낙 크니까, 어떻게든 재활용할 수 있는 방법을 찾아보는게 좋겠다.

함께 일하게 되면 이런 비슷한 일을 하게 된다고 하니, 잘 익히고 수행해봐야겠다! 화이팅 :)